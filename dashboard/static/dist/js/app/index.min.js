"use strict";var $api=new API,chartColors={benign:"#5cb85c",malicious:"#d9534f",pending:"#aaa"},createTimelineChart=function(t){var e={Pending:[],Benign:[],Malicious:[]};$.each(t,function(t,a){$.each(a.statuses,function(t,r){e[t].push([moment.utc(a.date).valueOf(),r])})});var a=[];$.each(e,function(t,e){a.push({name:t,data:e,cursor:"pointer",color:chartColors[t.toLowerCase()],marker:{symbol:"circle"},point:{events:{click:function(){$("[name='query']").val("date_reported:"+moment.utc(this.x).format("YYYY-MM-DD")+" AND status:"+this.series.name),$("#search_form").submit()}}}})});Highcharts.chart("timeline_chart",{chart:{type:"line",zoomType:"x",height:250},title:{text:""},xAxis:{type:"datetime",tickInterval:864e5,dateTimeLabelFormats:{day:"%Y-%m-%d"}},animation:!1,credits:!1,series:a})},createStatsChart=function(t){var e=[];$.each(t,function(t,a){if("total"==t)return!0;e.push({name:t.capitalize(),y:a,color:chartColors[t]})}),console.log(e);Highcharts.chart("stats_chart",{chart:{type:"pie",height:250},title:{text:""},plotOptions:{pie:{shadow:!1,center:["50%","50%"]}},credits:!1,series:[{name:"Reports",animation:!1,cursor:"pointer",point:{events:{click:function(){$("[name='query']").val("status:"+this.name),$("#search_form").submit()}}},innerSize:"60%",size:"80%",data:e}]})};$(document).ready(function(){$.getJSON("/stats",function(t){createStatsChart(t)}),$api.get_timeline().success(function(t){createTimelineChart(t)}),$("#reports-datatable").DataTable({searching:!1,paging:!1,lengthChange:!1,order:[[1,"desc"]],columnDefs:[{render:function(t,e,a){return'<a href="/reports/'+t+'">'+t+"</a>"},targets:0},{render:function(t,e,a){return moment.utc(t).local().format("MMMM Do YYYY, h:mm:ss a")},targets:1},{render:function(t,e,a){return templates.type_icon(t)},targets:3},{render:function(t,e,a){return templates.status_label(t)},targets:5}]})});