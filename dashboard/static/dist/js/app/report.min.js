"use strict";var $api=new API,modalFlash=function(t,e){$("#modal_flash").addClass(e).text(t).show()},html_preview=function(t){$("#html_preview").html(DOMPurify.sanitize(t)),$("#html_preview").tooltip({selector:"a",placement:"top",title:function(){return $(this).attr("href")}})},_update_status=function(t){$("#report-status").text(t),$("#report-status-btn").attr("class","btn btn-sm dropdown-toggle btn-"+templates.status_class(t))};$(document).ready(function(){var t=location.pathname.split("/").pop();_update_status($("#report-status").text()),$("#reply_form").submit(function(e){$api.post_report_reply(t,$("#reply_form").serializeObject()).success(function(t){new PNotify({title:"Reply Sent",text:"The response was sent successfully.",type:"success",styling:"bootstrap3"}),$("#modal_flash").hide(),$("#reply_modal").modal("hide")}).error(function(t){modalFlash(t.responseJSON.error,"alert-danger")}),e.preventDefault()}),$("#status-dropdown a").on("click",function(){var e=$(this).text();$api.put_report(t,{status:e}).success(function(t){_update_status(e),new PNotify({title:"Status Updated",text:"The report has been updated.",type:"success",styling:"bootstrap3"})}).error(function(t){new PNotify({title:"Error updating status",text:t.message,type:"danger",styling:"bootstrap3"})})}),$("[data-type='datetime']").each(function(t,e){var s=moment.utc($(this).text()).local().format("MMMM Do YYYY, h:mm a"),a=moment.utc($(this).text()).fromNow();$(this).text(s+" ("+a+")")})});